var app={init:function(){this.pageShow();this.swiperBtn();this.bigImg();this.leaveWordFun()},swiperBtn:function(){$(" .swiper-container ").on("mouseenter",function(){$(".swiper-button-prev,.swiper-button-next").removeClass("hide")});$(".swiper-container").on("mouseleave",function(){$(".swiper-button-prev,.swiper-button-next").addClass("hide")})},swiper1:function(){var a=new Swiper(".swiper-container1",{direction:"horizontal",effect:"fade",loop:true,autoplay:3000,speed:2000,autoplayDisableOnInteraction:false,pagination:".swiper-pagination",paginationClickable:true})},swiper2:function(){var a=new Swiper(".swiper-container2",{direction:"horizontal",slidesPerView:3,loop:true,autoplay:1500,speed:500,autoplayDisableOnInteraction:false,prevButton:".swiper-button-prev",nextButton:".swiper-button-next"})},swiper3:function(){var a=new Swiper(".swiper-container3",{direction:"horizontal",speed:2000,autoplayDisableOnInteraction:false,pagination:".swiper-pagination",paginationClickable:true,prevButton:".swiper-button-prev",nextButton:".swiper-button-next"})},element:function(b,c,e){var d=document.createElement(b);if(typeof(c)==="string"){e=c;c=null}if(c!==undefined){for(var a in c){d.setAttribute(a,c[a])}}if(e!==undefined){d.innerHTML=e}return d},pageShow:function(){$.ajax({url:"data/main.php",type:"get",success:function(a){this.bannerFun(a);this.newsFun(a);this.imgShowFun(a);this.specialtyFun(a)}.bind(this)})},bannerFun:function(e){var a=e.bannerList;var d=document.createDocumentFragment();for(var c=0;c<a.length;c++){var b=this.element("div",{"class":"swiper-slide",id:a[c].name},'<a href="javascript:void(0);">\n  <images src="images/'+a[c].src+'"/>\n  <p class="banner-text">'+a[c].title+"</p>\n</a>");$(b).appendTo($(d))}$(d).appendTo($(".swiper-container1 .swiper-wrapper"));this.swiper1()},newsFun:function(e){var d=e.newsList;var a=document.createDocumentFragment();var c=this.element("a",{href:"news.html",target:"_blank",style:"float: right;margin: 20px 10px 0 0;color:yellow"},"新闻头条>");for(var b=d.length-1;b>=0;b--){var f=this.element("div",{"class":"news-bulletin-item"},"<a href="+d[b].href+' class="clearfix" target="_blank">\n  <p class="item-title fl">\n'+d[b].title+'</p>\n  <p class="item-time fr">\n'+d[b].ntime+"</p>\n</a>");$(f).appendTo($(a))}$(c).appendTo($(a));$(a).appendTo($(".news-bulletin-content"))},imgShowFun:function(e){var f=e.bannerList;var d=document.createDocumentFragment();var a=f.length;for(var c=0;c<a;c++){for(var b=0;b<parseInt(f[c].imgcount);b++){var g=this.element("div",{"class":"swiper-slide"},'<a href="javascript:void(0);">\n  <images class=\'small-images\' src="images/scenery/'+f[c].name+"/"+f[c].name+"-0"+(b+1)+'.jpg"/>\n</a>');$(g).appendTo($(d))}}$(d).appendTo($(".swiper-container2 .swiper-wrapper"));this.swiper2()},specialtyFun:function(d){var a=d.specialtyList;var f=[];var h=document.createDocumentFragment();var c=document.createDocumentFragment();var j="specialty";for(var e=0;e<a.length;e++){f.push(a[e].name);if(a[e].type==="0"){j="specialty";var g=this.element("div",{"class":"specialty-item clearfix",id:a[e].name},'<div class="item-images">\n              <a>\n                <images class="center" src="images/'+j+"/"+a[e].name+"/"+a[e].name+'-01.jpg" alt="">\n              </a>\n            </div>\n            <div class="item-info">\n              <p class="item-title">\n                <a>'+a[e].title+'</a>\n              </p>\n              <p class="item-describe">'+a[e].des.split("|")[0]+"......<a>[详细]</a></p>\n            </div>");$(h).html($(g))}else{if(a[e].type==="1"){j="scenery";var b=this.element("div",{"class":"specialty-item clearfix",id:a[e].name},'<div class="item-images">\n              <a>\n                <images class="center" src="images/'+j+"/"+a[e].name+"/"+a[e].name+'-01.jpg" alt="">\n              </a>\n            </div>\n            <div class="item-info">\n              <p class="item-title">\n                <a>'+a[e].title+'</a>\n              </p>\n              <p class="item-describe">'+a[e].des.split("|")[0]+"......<a>[详细]</a></p>\n            </div>");$(c).html($(b))}}}$(".specialty-content").html($(h));$(".scenery-content").html($(c));$(".specialty-content,.scenery-content").on("click","a",function(k){if(k.target.tagName==="A"){var i=$(k.target).parents(".specialty-item").attr("id");sessionStorage.setItem("detailId",i);sessionStorage.setItem("idList",f);location.href="detail.html"}}.bind(this))},detailFun:function(){var b=sessionStorage.getItem("idList").split(",");var a="";var c=sessionStorage.getItem("detailId");for(var d=0;d<b.length;d++){if(b[d]===c){a=d}}this.detailShow(b[a]);$(".main-container .btn-prev").on("click",function(f){var f=f.target;a--;if(a<=0){this.detailShow(b[0]);$(f).html("这已经是第一条");a=0}else{this.detailShow(b[a]);$(f).html("上一条");$(".btn-next a").html("下一条")}}.bind(this));$(".main-container .btn-next").on("click",function(f){var f=f.target;a++;if(a>=b.length-1){this.detailShow(b[b.length-1]);$(f).html("这已经是最后一条");a=b.length-1}else{this.detailShow(b[a]);$(f).html("下一条");$(".btn-prev a").html("上一条")}}.bind(this))},detailShow:function(a){$.ajax({url:"data/detail.php?name="+a,type:"get",success:function(e){var l="specialty";if(e[0].type==="0"){l="specialty";$($(".home-nav li")[1]).addClass("active").siblings("li").removeClass("active")}else{if(e[0].type==="1"){l="scenery";$($(".home-nav li")[2]).addClass("active").siblings("li").removeClass("active")}}$(".detail-content .detail-title").html(e[0].title);var h=document.createDocumentFragment();for(var f=0;f<e[0].imgCount;f++){var b=this.element("div",{"class":"swiper-slide"},'<a href="javascript:void(0);">\n  <images class="small-images" src="images/'+l+"/"+e[0].name+"/"+e[0].name+"-0"+(f+1)+'.jpg" alt="">\n</a>');$(b).appendTo($(h))}$(".detail-banner .swiper-wrapper").html($(h));var g=document.createDocumentFragment();var k=e[0].des.split("|");for(var c=0;c<k.length;c++){var d=this.element("p",{"class":"describe-section"},k[c]);$(d).appendTo($(g))}$(".detail-describe").html($(g));this.swiper3()}.bind(this)})},bigImg:function(){$(".swiper-wrapper").on("click",".swiper-slide images.small-images",function(b){var b=b.target;var c=$(b).parents(".swiper-slide").index();var a=$(b).parents(".swiper-wrapper").find(".swiper-slide");$(".picture-large-show").show().children("images").attr("src",$(b).attr("src"));$(".picture-large-show .btn-prev").on("click",function(){if(c===0){c=a.length}var d=$(a[c-1]).find("images").attr("src");$(".picture-large-show").show().children("images").attr("src",d);c--});$(".picture-large-show .btn-next").on("click",function(){if(c===a.length){c=0}var d=$(a[c+1]).find("images").attr("src");$(".picture-large-show").show().children("images").attr("src",d);c++})});$(".picture-mask,.icon-mask-close").on("click",function(){$(".picture-large-show").hide()})},map:function(){var g=new BMap.Map("myMap");var a=new BMap.Point(111.4972064092,33.144480797);g.centerAndZoom(a,15);g.addControl(new BMap.MapTypeControl());g.enableScrollWheelZoom(true);var c=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});var f=new BMap.NavigationControl();g.addControl(c);g.addControl(f);var d=new BMap.OverviewMapControl();var e=new BMap.OverviewMapControl({isOpen:true,anchor:BMAP_ANCHOR_BOTTOM_RIGHT});g.addControl(d);g.addControl(e);var b=new BMap.Marker(a);g.addOverlay(b)},leaveWordFun:function(){$(".btn-submit").on("click",function(){var a=$(".leave-word-form").serialize();$.ajax({url:"data/leave-word-submit.php?"+a,type:"post",success:function(b){$(".leave-word-after").removeClass("hide");$(".leave-word-after .title").html(b.msg)}.bind(this)})}.bind(this));$(".leave-word-after .fl").on("click",function(){location.reload()});$(".leave-word-after .fr").on("click",function(){$(".leave-word-after,.leave-word-form").addClass("hide");$(".leave-word-list").removeClass("hide");var a=0;this.leaveWordPage(a);this.fenyeFun()}.bind(this));$(".leave-word-list .title a").on("click",function(){location.reload()})},leaveWordPage:function(a){$.ajax({url:"data/leave-word-show.php?start="+a,type:"get",success:function(d){var c=document.createDocumentFragment();for(var b=0;b<=d.pageList.length-1;b++){var e=this.element("div",{"class":"leave-word-item"},'<div class="top clearfix">\n              <p title=\'姓名\' class="lname">'+d.pageList[b].lname+"</p>\n              <p title='联系方式' class=\"lcontact\">"+d.pageList[b].lcontact+"</p>\n              <p>第"+d.pageList[b].nid+'楼</p>\n            </div>\n            <div class="lcontent">\n'+d.pageList[b].lcontent+'            </div>\n            <div class="ltime">\n'+d.pageList[b].ltime+"            </div>");$(e).appendTo($(c))}$(".leave-word-items").html($(c))}.bind(this)})},showPages:function(c,b){var d='<a class="active" href="#javascript:void(0);">'+c+"</a> ";for(var a=1;a<=3;a++){if(c-a>=1){d='<a href="#javascript:void(0);">'+(c-a)+"</a> "+d}if(c+a<b){d=d+'<a href="#javascript:void(0);">'+(c+a)+"</a> "}}if(c===5){d='<a href="#javascript:void(0);">上一页 </a> <a href="#javascript:void(0);">'+1+"</a> "+d}else{if(c-4>1){d='<a href="#javascript:void(0);">上一页 </a> <a href="#javascript:void(0);">'+1+"</a> ... "+d}}if(c+4<b){d=d+'...<a href="#javascript:void(0);">'+b+'</a> <a href="#javascript:void(0);"> 下一页</a> '}else{if(c<b){d=d+' <a href="#javascript:void(0);">'+b+'</a> <a href="#javascript:void(0);"> 下一页</a> '}}return d},update:function(c,b){var a=this.showPages(c,b);$(".pagination-device").html(a);console.log(b)},skip:function(b,a){$(".pagination-device").on("click","a",function(f){var d=f.target.innerHTML;var c=parseInt(d);if(c%1===0){b=c;$(f.target).addClass("active").siblings("a").removeClass("active")}if(d.indexOf("上")>-1){b--}if(d.indexOf("下")>-1){b++}this.leaveWordPage((b-1)*5);this.update(b,a)}.bind(this))},fenyeFun:function(){$.ajax({url:"data/leave-word-show.php?start=0",type:"get",success:function(b){var c=1;var a=Math.ceil(b.pageCount/5);this.update(c,a);this.skip(c,a)}.bind(this)})}};app.init();